<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CODEX Radio - MPF Documentation</title>
    <link rel="stylesheet" href="assets/css/main-style.css">
    <link rel="stylesheet" href="assets/css/combine-terminals.css">
    <link rel="stylesheet" href="assets/css/global-nav.css">
    <link rel="stylesheet" href="assets/css/interactive-system.css">
    <link rel="stylesheet" href="assets/css/combine-animations.css">
    <style>
        /* Code grid layout */
        .code-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .code-item {
            display: flex;
            align-items: flex-start;
            gap: 0.6rem;
            padding: 0.45rem 0.6rem;
            border-radius: 4px;
            transition: background 0.2s;
        }
        .code-item:hover { background: rgba(255,255,255,0.04); }
        .code-num {
            font-family: 'Share Tech Mono', monospace;
            font-weight: bold;
            min-width: 80px;
            font-size: 0.9rem;
            padding: 2px 6px;
            border-radius: 3px;
            text-align: center;
            flex-shrink: 0;
        }
        .code-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.4;
            flex-grow: 1;
        }
        .code-note {
            font-size: 0.75rem;
            color: #8ca0c7;
            margin-top: 2px;
            font-style: italic;
        }
        .section-divider {
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            padding-bottom: 0.5rem;
        }
        .section-divider h3 {
            font-family: 'Share Tech Mono', monospace;
            font-size: 1rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin: 0;
        }
        #codex-filter:focus {
            border-color: var(--accent-cyan);
            box-shadow: 0 0 8px rgba(0,170,255,0.2);
        }

        /* --- COULEURS DES CAT√âGORIES --- */

        /* CODES 10- : Bleu */
        .section-codes10 .section-divider h3 { color: #4287f5; }
        .section-codes10 .code-num {
            color: #4287f5;
            border: 1px solid rgba(66, 135, 245, 0.4);
            background: rgba(66, 135, 245, 0.1);
        }
        .section-codes10 { border-left: 3px solid #4287f5; padding-left: 1rem; }

        /* CODES 11- : Vert */
        .section-codes11 .section-divider h3 { color: #32CD32; }
        .section-codes11 .code-num {
            color: #32CD32;
            border: 1px solid rgba(50, 205, 50, 0.4);
            background: rgba(50, 205, 50, 0.1);
        }
        .section-codes11 { border-left: 3px solid #32CD32; padding-left: 1rem; }

        /* CODES S- : Or/Jaune */
        .section-codesS .section-divider h3 { color: #FFD700; }
        .section-codesS .code-num {
            color: #FFD700;
            border: 1px solid rgba(255, 215, 0, 0.4);
            background: rgba(255, 215, 0, 0.1);
        }
        .section-codesS { border-left: 3px solid #FFD700; padding-left: 1rem; }

        /* AUTRES CODES : Rouge Cramoisi */
        .section-autres .section-divider h3 { color: #DC143C; }
        .section-autres .code-num {
            color: #DC143C;
            border: 1px solid rgba(220, 20, 60, 0.4);
            background: rgba(220, 20, 60, 0.1);
        }
        .section-autres { border-left: 3px solid #DC143C; padding-left: 1rem; }

        /* Exemples de transmissions */
        .transmission-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.2rem;
            margin-top: 1rem;
        }
        .transmission-card {
            padding: 1.2rem;
            background: rgba(0,0,0,0.3);
            border: 1px solid #2a4a6a;
            border-radius: 4px;
        }
        .transmission-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(66, 135, 245, 0.3);
        }
        .transmission-id {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.72rem;
            color: #8ca0c7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .transmission-status {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 2px;
            background: rgba(66, 135, 245, 0.2);
            color: #8cb4ff;
            text-transform: uppercase;
        }
        .transmission-content {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.85rem;
            color: #ffffff;
            line-height: 1.6;
            margin-bottom: 0.6rem;
        }
        .transmission-decoded {
            margin-top: 0.6rem;
            padding: 0.7rem;
            background: rgba(0,0,0,0.4);
            border-left: 3px solid #32CD32;
            font-size: 0.8rem;
            color: #b0c4de;
            line-height: 1.5;
        }

        @media (max-width: 700px) {
            .code-grid { grid-template-columns: 1fr; }
            .transmission-grid { grid-template-columns: 1fr; }
            .code-num { min-width: 65px; font-size: 0.8rem; }
        }
    </style>
</head>
<body>
    <div class="scanline-overlay"></div>
    <div class="particles-bg"></div>

    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo-icon">M</div>
                    <div>
                        <h1 class="logo">MPF</h1>
                        <p class="logo-subtitle">Metropolice Force Documentation</p>
                    </div>
                </div>
                <div id="authBtn"></div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="combine-terminal-wrapper animate-fadeInUp">
                <div class="combine-header">
                    <h2>SYST√àME DE CODES RADIO</h2>
                    <span class="header-code">COMMUNICATION://CODES_OP√âRATIONNELS_V3</span>
                </div>

                <div class="combine-body">

                    <!-- Barre de recherche de codes -->
                    <div id="codex-search-box" style="margin-bottom: 1.5rem;">
                        <div style="position: relative;">
                            <input type="text" id="codex-filter" placeholder="Filtrer les codes... ex: 10-4, patrouille, escorte..."
                                   style="width:100%;padding:0.6rem 1rem 0.6rem 2.4rem;background:rgba(0,170,255,0.05);border:1px solid rgba(0,170,255,0.3);color:var(--text-primary);font-family:'Share Tech Mono',monospace;font-size:0.85rem;outline:none;border-radius:4px;transition:border-color 0.3s;"
                                   autocomplete="off">
                            <span style="position:absolute;left:0.8rem;top:50%;transform:translateY(-50%);color:var(--accent-cyan);font-size:0.9rem;">&#128269;</span>
                        </div>
                        <div id="codex-count" style="margin-top:0.4rem;font-size:0.75rem;color:var(--text-muted);font-family:'Share Tech Mono',monospace;"></div>
                    </div>

                    <!-- CODES 10- STATUTS & OP√âRATIONS -->
                    <div class="section-codes10">
                        <div class="section-divider">
                            <h3>CODES 10- ‚Äî STATUTS & OP√âRATIONS</h3>
                        </div>
                        <div class="code-grid">
                            <div class="code-item"><div class="code-num">10-X0</div><div class="code-desc">N√©crotiques</div></div>
                            <div class="code-item"><div class="code-num">10-00</div><div class="code-desc">Evisc√©rateur lanc√©</div></div>
                            <div class="code-item"><div class="code-num">10-2</div><div class="code-desc">Affirmatif / Re√ßu</div></div>
                            <div class="code-item"><div class="code-num">10-3</div><div class="code-desc">N√©gatif</div></div>
                            <div class="code-item"><div class="code-num">10-4</div><div class="code-desc">Hostile</div></div>
                            <div class="code-item"><div class="code-num">10-5</div><div class="code-desc">Passif</div></div>
                            <div class="code-item"><div class="code-num">10-6</div><div class="code-desc">Unit√© occup√©e</div></div>
                            <div class="code-item"><div class="code-num">10-7</div><div class="code-desc">Unit√© libre</div></div>
                            <div class="code-item"><div class="code-num">10-08</div><div class="code-desc">Unit√© PC (MPF)</div></div>
                            <div class="code-item"><div class="code-num">10-08e</div><div class="code-desc">Unit√© d'√âlite (MPEF = 02 et plus)</div></div>
                            <div class="code-item"><div class="code-num">10-08i</div><div class="code-desc">Unit√© Intelligente (STB/STBE)</div></div>
                            <div class="code-item"><div class="code-num">10-08t</div><div class="code-desc">Unit√© Transhumaine (OTA)</div></div>
                            <div class="code-item"><div class="code-num">10-08te</div><div class="code-desc">Unit√© Transhumaine d'√âlite (OTA)</div></div>
                            <div class="code-item"><div class="code-num">10-08m</div><div class="code-desc">Unit√© M√©canique (Scanner)</div></div>
                            <div class="code-item"><div class="code-num">10-12</div><div class="code-desc">En attente</div></div>
                            <div class="code-item"><div class="code-num">10-13</div><div class="code-desc">Unit√© en service</div></div>
                            <div class="code-item"><div class="code-num">10-14</div><div class="code-desc">Personne suspecte</div></div>
                            <div class="code-item"><div class="code-num">10-15</div><div class="code-desc">Administrez</div></div>
                            <div class="code-item"><div class="code-num">10-16</div><div class="code-desc">Objectif Principale (√† utiliser en 10-50)</div></div>
                            <div class="code-item"><div class="code-num">10-17</div><div class="code-desc">En mission</div></div>
                            <div class="code-item"><div class="code-num">10-20</div><div class="code-desc">Localisation</div></div>
                            <div class="code-item"><div class="code-num">10-25</div><div class="code-desc">Rendez-vous (accompagn√© d'un 10-20)</div></div>
                            <div class="code-item"><div class="code-num">10-27</div><div class="code-desc">V√©rification de data</div></div>
                            <div class="code-item"><div class="code-num">10-34</div><div class="code-desc">√âmeute</div></div>
                            <div class="code-item"><div class="code-num">10-40</div><div class="code-desc">Transmission termin√©e</div></div>
                            <div class="code-item"><div class="code-num">10-43</div><div class="code-desc">Test de loyaut√©</div></div>
                            <div class="code-item"><div class="code-num">10-44</div><div class="code-desc">Fin de service</div></div>
                            <div class="code-item"><div class="code-num">10-45</div><div class="code-desc">Pr√™t √† amputer</div></div>
                            <div class="code-item"><div class="code-num">10-48</div><div class="code-desc">Message re√ßu ?</div></div>
                            <div class="code-item"><div class="code-num">10-50</div><div class="code-desc">Patrouille</div></div>
                            <div class="code-item"><div class="code-num">10-51</div><div class="code-desc">Fin de patrouille</div></div>
                            <div class="code-item"><div class="code-num">10-60</div><div class="code-desc">D√©but</div></div>
                            <div class="code-item"><div class="code-num">10-61</div><div class="code-desc">Fin</div></div>
                            <div class="code-item"><div class="code-num">10-63</div><div class="code-desc">Demande...</div></div>
                            <div class="code-item"><div class="code-num">10-63e</div><div class="code-desc">Ex√©cution des ordres!</div></div>
                            <div class="code-item"><div class="code-num">10-64c</div><div class="code-desc">Canal</div></div>
                            <div class="code-item"><div class="code-num">10-67</div><div class="code-desc">St√©rilisez</div></div>
                            <div class="code-item"><div class="code-num">10-68</div><div class="code-desc">Ravitaillement en cours</div></div>
                            <div class="code-item"><div class="code-num">10-74</div><div class="code-desc">Documenter</div></div>
                            <div class="code-item"><div class="code-num">10-75</div><div class="code-desc">Permission de Documenter</div></div>
                            <div class="code-item"><div class="code-num">10-76</div><div class="code-desc">Unit√© en route</div></div>
                            <div class="code-item"><div class="code-num">10-85</div><div class="code-desc">Protection</div></div>
                            <div class="code-item"><div class="code-num">10-85S</div><div class="code-desc">Protection de Session</div></div>
                            <div class="code-item"><div class="code-num">10-91</div><div class="code-desc">Embarquement du suspect</div></div>
                            <div class="code-item"><div class="code-num">10-92</div><div class="code-desc">Suspect en d√©tention</div></div>
                            <div class="code-item"><div class="code-num">10-94</div><div class="code-desc">Rapport √©crit</div></div>
                            <div class="code-item"><div class="code-num">10-100</div><div class="code-desc">Officier de la PC</div></div>
                            <div class="code-item"><div class="code-num">10-101</div><div class="code-desc">Unit√©s PC locales au rapport</div></div>
                            <div class="code-item"><div class="code-num">10-103m/p</div><div class="code-desc">D√©ficiance Mentale/Physique</div></div>
                            <div class="code-item"><div class="code-num">10-106</div><div class="code-desc">Citoyen</div></div>
                            <div class="code-item"><div class="code-num">10-107</div><div class="code-desc">Anti-Citoyen <span class="code-note">(Pr√©cisez si 404 ou 505)</span></div></div>
                            <div class="code-item"><div class="code-num">10-114</div><div class="code-desc">Loyaliste</div></div>
                            <div class="code-item"><div class="code-num">10-115</div><div class="code-desc">CWU</div></div>
                            <div class="code-item"><div class="code-num">10-117</div><div class="code-desc">Superviseur</div></div>
                            <div class="code-item"><div class="code-num">10-118</div><div class="code-desc">Personnalit√© importante</div></div>
                            <div class="code-item"><div class="code-num">10-119</div><div class="code-desc">Administrateur</div></div>
                        </div>
                    </div>

                    <!-- CODES 11- URGENCES & ASSISTANCE -->
                    <div class="section-codes11">
                        <div class="section-divider">
                            <h3>CODES 11- ‚Äî URGENCES & ASSISTANCE</h3>
                        </div>
                        <div class="code-grid">
                            <div class="code-item"><div class="code-num">11-40</div><div class="code-desc">Fin de message</div></div>
                            <div class="code-item"><div class="code-num">11-47</div><div class="code-desc">Bless√©</div></div>
                            <div class="code-item"><div class="code-num">11-50</div><div class="code-desc">Escorte en cours</div></div>
                            <div class="code-item"><div class="code-num">11-51</div><div class="code-desc">Demande d'escorte</div></div>
                            <div class="code-item"><div class="code-num">11-58</div><div class="code-desc">Fr√©quence radio corrompue</div></div>
                            <div class="code-item"><div class="code-num">11-59</div><div class="code-desc">Zone de danger, restez en alerte</div></div>
                            <div class="code-item"><div class="code-num">11-78</div><div class="code-desc">V√©rification d'identit√© CWU ‚Äî Fourchette : <strong id="cwu-code-codex" style="color: #32CD32;">K | 143 ‚Äì 162</strong></div></div>
                            <div class="code-item"><div class="code-num">11-99</div><div class="code-desc">Demande renfort (assistance)</div></div>
                        </div>
                    </div>

                    <!-- CODES S- SITUATIONS & INCIDENTS -->
                    <div class="section-codesS">
                        <div class="section-divider">
                            <h3>CODES S- ‚Äî SITUATIONS & INCIDENTS</h3>
                        </div>
                        <div class="code-grid">
                            <div class="code-item"><div class="code-num">S08</div><div class="code-desc">Responsabilit√© point de passage</div></div>
                            <div class="code-item"><div class="code-num">S09</div><div class="code-desc">Responsabilit√© distribution ration</div></div>
                            <div class="code-item"><div class="code-num">S25</div><div class="code-desc">Feu</div></div>
                            <div class="code-item"><div class="code-num">S26</div><div class="code-desc">Suspect Pyromane</div></div>
                            <div class="code-item"><div class="code-num">S30</div><div class="code-desc">Sociocide</div></div>
                            <div class="code-item"><div class="code-num">S34</div><div class="code-desc">Fusillade / Combat</div></div>
                            <div class="code-item"><div class="code-num">S44</div><div class="code-desc">Suicide</div></div>
                            <div class="code-item"><div class="code-num">S51</div><div class="code-desc">Alarme</div></div>
                            <div class="code-item"><div class="code-num">S55</div><div class="code-desc">Intrusion</div></div>
                            <div class="code-item"><div class="code-num">S63P</div><div class="code-desc">Usurpation d'identit√© PC</div></div>
                            <div class="code-item"><div class="code-num">S63C</div><div class="code-desc">Usurpation d'identit√© Civile</div></div>
                            <div class="code-item"><div class="code-num">S99</div><div class="code-desc">Personne recherch√©e</div></div>
                        </div>
                    </div>

                    <!-- AUTRES CODES SP√âCIAUX & SP√âCIFIQUES -->
                    <div class="section-autres">
                        <div class="section-divider">
                            <h3>AUTRES CODES ‚Äî SP√âCIAUX & SP√âCIFIQUES</h3>
                        </div>
                        <div class="code-grid">
                            <div class="code-item"><div class="code-num">Code A-G</div><div class="code-desc">Niveau de verdict 1-7</div></div>
                            <div class="code-item"><div class="code-num">Code 0</div><div class="code-desc">Op√©ration compromise</div></div>
                            <div class="code-item"><div class="code-num">Code 3</div><div class="code-desc">Urgence !</div></div>
                            <div class="code-item"><div class="code-num">Code 7</div><div class="code-desc">Rassemblement Nexus</div></div>
                            <div class="code-item"><div class="code-num">Code 10</div><div class="code-desc">Rassemblement pour dispatch</div></div>
                            <div class="code-item"><div class="code-num">Code 12</div><div class="code-desc">Retour √† vos objectifs principaux</div></div>
                            <div class="code-item"><div class="code-num">Code 100</div><div class="code-desc">Rien en vue !</div></div>
                            <div class="code-item"><div class="code-num">Code Minuit</div><div class="code-desc">Silence Absolu</div></div>
                            <div class="code-item"><div class="code-num">00v</div><div class="code-desc">Mort !</div></div>
                            <div class="code-item"><div class="code-num">B10</div><div class="code-desc">Bloquez</div></div>
                            <div class="code-item"><div class="code-num">647E</div><div class="code-desc">Anti-citoyen en Fuite !</div></div>
                            <div class="code-item"><div class="code-num">52E</div><div class="code-desc">Explosif</div></div>
                            <div class="code-item"><div class="code-num">404</div><div class="code-desc">Non-arm√© <span class="code-note">[Signalez 10-107 404]</span></div></div>
                            <div class="code-item"><div class="code-num">505</div><div class="code-desc">Arm√© <span class="code-note">[Signalez 10-107 505]</span></div></div>
                            <div class="code-item"><div class="code-num">3-22</div><div class="code-desc">Surveillance en cours</div></div>
                            <div class="code-item"><div class="code-num">Igloo</div><div class="code-desc">Nexus</div></div>
                            <div class="code-item"><div class="code-num">CnB 1-3</div><div class="code-desc">Contrebande de niveau 1-3</div></div>
                        </div>
                    </div>

                    <!-- EXEMPLES DE TRANSMISSIONS -->
                    <div style="margin-top: 2.5rem; padding: 1.5rem; background: rgba(42, 74, 106, 0.1); border: 1px solid #2a4a6a; border-radius: 4px;">
                        <h3 style="color: #4287f5; margin-top: 0; font-size: 1rem; margin-bottom: 1rem; font-family: 'Share Tech Mono', monospace; text-transform: uppercase; letter-spacing: 1px;">üì° EXEMPLES DE TRANSMISSIONS</h3>

                        <div class="transmission-grid">
                            <div class="transmission-card">
                                <div class="transmission-header">
                                    <div class="transmission-id">TRANSMISSION #C17.MPF-03-DEFENDER.424</div>
                                    <div class="transmission-status">STANDARD</div>
                                </div>
                                <div class="transmission-content">
                                    "10-101 10-08e 01.018 + 10-08 03.110|10-50 10-20 PZ/D1|10-16 Recherche CNB|11-40."
                                </div>
                                <div class="transmission-decoded">
                                    <strong>Traduction :</strong> "Unit√©s PC locales au rapport. Unit√©s d'√©lite 01.310 + Unit√© 03.456. Patrouille localisation PZ/D1, Recherche Contrebandes|Fin de message."
                                </div>
                            </div>

                            <div class="transmission-card">
                                <div class="transmission-header">
                                    <div class="transmission-id">TRANSMISSION C17.MPEF-01-MACE.500-004</div>
                                    <div class="transmission-status">JUDICIAIRE</div>
                                </div>
                                <div class="transmission-content">
                                    "10-101 10-08e 01.500|11-50 sur ma 10-20 11-99 je suis seul|11-40."
                                </div>
                                <div class="transmission-decoded">
                                    <strong>Traduction :</strong> "Unit√©s PC locales au rapport. Unit√©s d'√©lite 01.500|Escorte en cours sur ma localisation, besoin de renforts. Je suis seul|Fin de message."
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="combine-footer">
                    [CODEX_RADIO_V3 ‚Äî COMMUNICATION_PROTOCOL_ACTIVE]
                </div>
            </div>
        </div>
    </main>

    <script src="assets/js/global-nav.js"></script>
    <script src="assets/js/interactive-system.js"></script>
    <script src="assets/js/combine-animations.js"></script>
    <script type="module">
        // Charger le code CWU depuis Firestore pour l'afficher dynamiquement
        import { db } from './assets/js/auth.js';
        import { doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        try {
            const snap = await getDoc(doc(db, 'settings', 'cwu'));
            if (snap.exists() && snap.data().cwucode) {
                const el = document.getElementById('cwu-code-codex');
                if (el) el.textContent = snap.data().cwucode;
            }
        } catch (e) { console.warn('Code CWU non charg√©:', e); }
    </script>
    <script>
    // Codex-specific code filter
    (function() {
        function initCodexFilter() {
            const input = document.getElementById('codex-filter');
            const countDiv = document.getElementById('codex-count');
            if (!input) return;

            const allItems = document.querySelectorAll('.code-item');
            const sectionWrappers = document.querySelectorAll('.section-codes10, .section-codes11, .section-codesS, .section-autres');
            const total = allItems.length;

            function normalize(s) {
                return s.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase().trim();
            }

            function filter() {
                const q = normalize(input.value);
                let visible = 0;

                if (!q) {
                    allItems.forEach(el => { el.style.display = ''; });
                    sectionWrappers.forEach(s => { s.style.display = ''; });
                    countDiv.textContent = '';
                    return;
                }

                const terms = q.split(/\s+/).filter(t => t.length > 0);

                allItems.forEach(item => {
                    const num = normalize(item.querySelector('.code-num')?.textContent || '');
                    const desc = normalize(item.querySelector('.code-desc')?.textContent || '');
                    const haystack = num + ' ' + desc;

                    const match = terms.every(t => haystack.includes(t));
                    item.style.display = match ? '' : 'none';
                    if (match) visible++;
                });

                sectionWrappers.forEach(section => {
                    const hasVisible = [...section.querySelectorAll('.code-item')].some(el => el.style.display !== 'none');
                    section.style.display = hasVisible ? '' : 'none';
                });

                countDiv.textContent = visible === 0
                    ? 'Aucun code trouv√©.'
                    : visible + ' / ' + total + ' codes';
            }

            input.addEventListener('input', filter);

            document.addEventListener('keydown', function(e) {
                if (e.key === '/' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
                    e.preventDefault();
                    input.focus();
                    input.select();
                }
            });
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initCodexFilter);
        } else {
            initCodexFilter();
        }
    })();
    </script>
</body>
</html>
